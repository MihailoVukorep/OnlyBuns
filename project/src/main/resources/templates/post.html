<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">

<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/x-icon" href="/img/favicon.png">
    <link rel="stylesheet" href="/css/main.css">
    <title>OnlyBuns - Post</title>

    <link rel="stylesheet" href="/css/post.css">
    <link rel="stylesheet" href="/css/commentform.css">
    <link rel="stylesheet" href="/css/popup.css">

    <link rel="stylesheet" href="/css/animations/rainbow_h1.css">

    <script defer type="text/javascript" src="/js/popup.js"></script>
    <script defer type="text/javascript" src="/js/actions.js"></script>
</head>

<body>
    <input type="hidden" id="post_id" th:value="${post_id}" />

    <div th:replace="~{fragments/navbar :: navbar}"></div>

    <a id="parent"
    th:if="${posts != null and posts.size() > 0 and posts[0].parentPostId != null}"
    th:href="@{/posts/{id}(id=${posts[0].parentPostId})}"
    style="display: block;">üîù Parent Post</a>

    <div id="posts">
        <div th:each="post : ${posts}" class="post" th:style="'margin-left:' + ${post.indent} + 'px'">
            <a class="post_body_link" th:href="@{/posts/{id}(id=${post.id})}">
                <div class="post_body">
                    <div class="post_content">
                        <span class="post_title" th:text="${post.title}"></span>
                        <span class="post_text" th:text="${post.text}"></span>
                        <img class="post_picture" th:src="${post.picture}" th:if="${post.picture != null}" />
                    </div>
                </div>
            </a>

            <div class="post_controls">
                <button class="post_controls_like" 
                        th:value="${post.likes}"
                        th:classappend="${post.isLiked} ? 'liked' : ''" 
                        th:text="${post.isLiked ? 'üíó' : '‚ù§Ô∏è'} + ' ' + ${post.likes}"
                        th:onclick="'post_like(' + ${post.id} + ', this);'">
                </button>

                <button class="post_controls_comment" th:text="'üí¨ ' + ${post.totalChildren}"
                    th:onclick="'showCommentForm(' + ${post.id} + ');'">
                </button>

                <button th:if="${post.isMyPost}" class="post_controls_update"
                    th:onclick="'post_update(' + ${post.id} + ');'">
                    üìù
                </button>
                <button th:if="${post.isMyPost}" class="post_controls_delete"
                    th:onclick="'post_delete(' + ${post.id} + ');'">
                    ‚ùå
                </button>

                <div class="post_account">
                    <a class="post_account_link" th:href="@{/accounts/{id}(id=${post.account.id})}">
                        <img class="post_account_image" th:src="${post.account.avatar}" />
                        <span class="post_account_userName" th:text="${post.account.userName}"></span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div th:replace="~{fragments/commentForm :: commentForm}"></div>

    <div th:replace="~{fragments/popup :: popup}"></div>
</body>

</html>
